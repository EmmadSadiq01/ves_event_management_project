<!-- <?php

// $server =  "localhost";
// $username = "root";
// $password = "";
// $database = "ves_mhs";

// $connection = mysqli_connect($server, $username, $password, $database);


// if ($_SERVER['REQUEST_METHOD'] == 'POST') {

//   $query = "INSERT INTO inquery";
//   $result = mysqli_query($query, $connection);
// }

?> -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="evo-calendar.min.css" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="evo-calendar.midnight-blue.min.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://pro.fontawesome.com/releases/v5.10.0/css/duotone.css"
      integrity="sha384-R3QzTxyukP03CMqKFe0ssp5wUvBPEyy9ZspCB+Y01fEjhMwcXixTyeot+S40+AjZ"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://pro.fontawesome.com/releases/v5.10.0/css/fontawesome.css"
      integrity="sha384-eHoocPgXsiuZh+Yy6+7DsKAerLXyJmu2Hadh4QYyt+8v86geixVYwFqUvMU8X90l"
      crossorigin="anonymous"
    />
  </head>

  <body>
    <section class="calendar">
      <div class="row">
        <div class="col-8 p-0">
          <div id="calendar" class="event-hide sidebar-hide"></div>
        </div>
        <div class="col-4 p-0">
          <div class="bookings">
            <div class="booking_container">
              <div class="booking_header">
                <p>March 27 2021</p>
              </div>
              <div class="booking-empty">
                <p>No event for today.. so take a rest! :)</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!--Inquiry Modal -->
    <div
      class="modal fade"
      id="exampleModal"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add Inquiry</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <form action="">
            <div class="modal-body">
              <div class="mb-3">
                <label for="date" class="form-label">Date</label>
                <input
                  type="date"
                  name="event_date"
                  class="form-control"
                  id="On_event_date"
                />
                <!-- <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div> -->
              </div>
              <div class="mb-3">
                <small>Select Hall</small>
                <label for="hall" class="form-label">A</label>
                <input
                  type="radio"
                  name="hall"
                  value="a"
                  id="hall"
                  class="form-label"
                />
                <label for="hall" class="form-label">B</label>
                <input
                  type="radio"
                  name="hall"
                  value="b"
                  id="hall"
                  class="form-label"
                />
              </div>
              <div class="mb-3">
                <label for="event_name" class="form-label">Event Name</label>
                <input
                  type="text"
                  name="name"
                  class="form-control"
                  id="event_name"
                />
              </div>
              <div class="mb-3">
                <label for="event_cost" class="form-label"
                  >Estimated Cost Rs.</label
                >
                <input
                  type="number"
                  name="cost"
                  class="form-control"
                  id="event_cost"
                />
              </div>
              <div class="mb-3">
                <label for="event_number_guest" class="form-label"
                  >No. of Guest</label
                >
                <input
                  type="number"
                  name="number_guest"
                  class="form-control"
                  id="event_number_guest"
                />
              </div>
              <div class="mb-3">
                <label for="guest_contact" class="form-label">Contact</label>
                <input
                  type="text"
                  name="number_guest"
                  class="form-control"
                  id="contact"
                />
              </div>
              <button type="button" class="btn btn-primary"  onclick="eventHandler()">Save</button>

              <!-- <button type="button" class="btn btn-primary">Booking</button> -->
            </div>
            <!-- <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="Submit" class="btn btn-primary">Save changes</button>
      </div> -->
          </form>
        </div>
      </div>
    </div>
    <!-- edit inquiry modal -->
    <div
      class="modal fade"
      id="editModal"
      tabindex="-1"
      aria-labelledby="editModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit Inquiry</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <form action="">
            <div class="modal-body">
              <div class="mb-3">
                <input type="hidden" id="edit_id">
                <label for="editDate" class="form-label">Date</label>
                <input
                  type="date"
                  name="event_date"
                  class="form-control"
                  id="Edit_On_event_date"
                />
                <!-- <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div> -->
              </div>
              <div class="mb-3">
                <small>Select Hall</small>
                <label for="edit_hall" class="form-label">A</label>
                <input
                  type="radio"
                  name="edit_hall"
                  value="a"
                  id="edit_a"
                  class="form-label"
                />
                <label for="edit_hall" class="form-label">B</label>
                <input
                  type="radio"
                  name="edit_hall"
                  value="b"
                  id="edit_b"
                  class="form-label"
                />
              </div>
              <div class="mb-3">
                <label for="edit_event_name" class="form-label">Event Name</label>
                <input
                  type="text"
                  name="name"
                  class="form-control"
                  id="edit_event_name"
                />
              </div>
              <div class="mb-3">
                <label for="edit_event_cost" class="form-label"
                  >Estimated Cost Rs.</label
                >
                <input
                  type="number"
                  name="cost"
                  class="form-control"
                  id="edit_event_cost"
                />
              </div>
              <div class="mb-3">
                <label for="edit_event_number_guest" class="form-label"
                  >No. of Guest</label
                >
                <input
                  type="number"
                  name="number_guest"
                  class="form-control"
                  id="edit_event_number_guest"
                />
              </div>
              <div class="mb-3">
                <label for="edit_contact" class="form-label">Contact</label>
                <input
                  type="text"
                  name="number_guest"
                  class="form-control"
                  id="edit_contact"
                />
              </div>
              <button type="button" class="btn btn-primary" onclick="editEventHandler()">Update</button>

              <!-- <button type="button" class="btn btn-primary">Booking</button> -->
            </div>
            <!-- <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="Submit" class="btn btn-primary">Save changes</button>
      </div> -->
          </form>
        </div>
      </div>
    </div>
    <!--Booking Modal -->
    <div
      class="modal fade"
      id="booking_modal"
      tabindex="-1"
      aria-labelledby="booking_modal"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Booking</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <form>
            <div class="modal-body">
              <div class="row">
                <div class="col">
                  <small>Booking Date</small>
                  <input type="date" class="form-control" />
                </div>
                <div class="col">
                  <small>Program Date</small>
                  <input type="date" class="form-control" />
                </div>
                <div class="col">
                  <small>Day</small>
                  <input type="text" class="form-control" />
                </div>
              </div>
              <div class="mb-3">
                <small>Shift</small>
                <label for="morning" class="form-label">Morning</label>
                <input
                  type="radio"
                  name="shift"
                  value="morning"
                  id="morning"
                  class="form-label"
                />
                <label for="evening" class="form-label">Evening</label>
                <input
                  type="radio"
                  name="shift"
                  value="evening"
                  id="evening"
                  class="form-label"
                />
              </div>
              <div class="mb-3">
                <label for="name" class="form-label">Name</label>
                <input type="text" name="name" class="form-control" id="name" />
              </div>
              <div class="mb-3">
                <label for="address" class="form-label">Address</label>
                <textarea
                  type="number"
                  name="address"
                  class="form-control"
                  id="address"
                  cols="30"
                  rows="1"
                ></textarea>
              </div>
              <div class="mb-3">
                <label for="cell_no" class="form-label">Cell No</label>
                <input
                  type="text"
                  name="cell_no"
                  class="form-control"
                  id="cell_no"
                />
              </div>
              <div class="mb-3">
                <label for="event_name" class="form-label">Event Name</label>
                <input
                  type="text"
                  name="event_name"
                  class="form-control"
                  id="event_name"
                />
              </div>
              <div class="mb-3">
                <label for="advance" class="form-label">Advance</label>
                <input
                  type="text"
                  name="advance"
                  class="form-control"
                  id="advance"
                />
              </div>
              <div class="mb-3">
                <label for="balance" class="form-label">Balance</label>
                <input
                  type="text"
                  name="balance"
                  class="form-control"
                  id="balance"
                />
              </div>
              <div class="mb-3">
                <label for="booking_no_of_guests" class="form-label"
                  >No. of Guest</label
                >
                <input
                  type="text"
                  name="booking_no_of_guests"
                  class="form-control"
                  id="booking_no_of_guests"
                />
              </div>
              <button type="button" class="btn btn-primary">Book</button>
            </div>
            <!-- <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="Submit" class="btn btn-primary">Save changes</button>
      </div> -->
          </form>
        </div>
      </div>
    </div>
    <!-- <a
      class="btn btn-primary"
      data-bs-toggle="modal"
      data-bs-target="#booking_modal"
      >Open #modal</a
    > -->

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
      crossorigin="anonymous"
    ></script>

    <script src="evo-calendar.js"></script>
    <script>
      let eventdate = "";
      let myEvents = [];
      let pushEnvents = {};
      let newEnvents = [];
      let after_split = "";
      let calendarEvents = [];

      // $(document).ready(function() {
      let url = "http://localhost/API_Inquery/api-fetch-all.php";
      fetch(url)
        .then((res) => res.json())
        .then((out) => {
          var monthsArray = new Array();
          monthsArray[0] = "January";
          monthsArray[1] = "February";
          monthsArray[2] = "march";
          monthsArray[3] = "April";
          monthsArray[4] = "May";
          monthsArray[5] = "June";
          monthsArray[6] = "July";
          monthsArray[7] = "August";
          monthsArray[8] = "September";
          monthsArray[9] = "October";
          monthsArray[10] = "November";
          monthsArray[11] = "December";
          for (let i = 0; i < out.length; i++) {
            eventdate = out[i].inquery_date;
            // console.log(eventdate)
            changeFormat = eventdate.split("-");
            let year = changeFormat[0];
            // let getMonth = new Date(eventdate).getMonth();
            let month = changeFormat[1] - 1;
            let date = changeFormat[2];
            // console.log(month)
            // let more_split_date = date.split(" ");
            after_split = monthsArray[month] + "/" + date + "/" + year;
            // console.log("in then", after_split);

            pushEnvents = {
              id: out[i].iquery_id,
              name: out[i].event_name,
              date: after_split,
              type: out[i].iquery_id,
              description:
                "Hall: " +
                out[i].hallportion +
                "</br>Cost: " +
                out[i].estimated_cost +
                "</br>Conact:" +
                out[i].personContact,
              everyYear: false,
              color: "red",
            };
            myEvents.push(pushEnvents);
          }
          // console.log(newEnvents);
          // myEvents = [
          //   {
          //     id: "1", // Event's ID (required)
          //     name: "Emmad Function", // Event name (required)
          //     date: after_split, // Event date (required)
          //     type: "A", // Event type (required)
          //     description:
          //       "Hall: A </br>Cost: 25,000 </br>Guest: 300 </br>Conact: 03412725048 ",
          //     everyYear: false, // Same event every year (optional)
          //     color: "red",
          //   }
          // ];
          $("#calendar").evoCalendar({
            theme: "Midnight Blue",
            // settingName: settingValue
            calendarEvents: myEvents,
          });
          // console.log(out)
        })
        // .then(() => {
        //
        // })
        .catch((err) => {
          throw err;
        });
      // let calendarEvents = [];
      // myEvents = [
      //   {
      //     id: "1", // Event's ID (required)
      //     name: "Emmad Function", // Event name (required)
      //     date: after_split, // Event date (required)
      //     type: "A", // Event type (required)
      //     description:
      //       "Hall: A </br>Cost: 25,000 </br>Guest: 300 </br>Conact: 03412725048 ",
      //     everyYear: false, // Same event every year (optional)
      //     color: "red",
      //   },
      //   {
      //     id: "2", // Event's ID (required)
      //     name: "Hasnain Function", // Event name (required)
      //     date: "march/01/2021", // Event date (required)
      //     type: "B", // Event type (required)
      //     description:
      //       "Hall: B </br>Cost: 57,000 </br>Guest: 300 </br>Conact: 03412725048 ",
      //     everyYear: false, // Same event every year (optional)
      //     color: "blue",
      //   },
      // ];
      // $("#calendar").evoCalendar({
      //   theme: "Midnight Blue",
      //   // settingName: settingValue
      //   calendarEvents: myEvents,
      // });
      // console.log($("#calendar").evoCalendar())

      // console.log(myEvents[0].name);
      // });
      // console.log(myEvents);
      // console.log("format date =>", after_split);

      function eventHandler() {
        let date = document.getElementById("On_event_date").value;
        let event_name = document.getElementById("event_name").value;
        let event_cost = document.getElementById("event_cost").value;
        let event_number_guest = document.getElementById("event_number_guest")
          .value;
        let party_contact = document.getElementById("contact").value;
        let hall = "";
        let hall_select = document.getElementsByName("hall");
        for (i = 0; i < hall_select.length; i++) {
          if (hall_select[i].checked) {
            hall = hall_select[i].value;
          }
        }
        let push_data = {
          idate: date,
          ihijtidate: "HIJRI DATE",
          iname: "hello Name",
          iaddress: "ADDREESS",
          icontact: party_contact,
          icnic: "421010-49239482-4",
          iemail: "EMMADSADIQ@GMAIL.COM",
          iportion: hall,
          ievent: event_name,
          icost: event_cost,
          iguest: event_number_guest,
        };
        // console.log("data=>",push_data);
        fetch("http://localhost/API_Inquery/api-insert.php", {
          method: "POST",
          body: JSON.stringify(push_data),
        })
          .then((result) => {
            result.json();
          })
          .catch((err) => {
            throw err;
          });

        // console.log(myEvents);
      }
     const  editEventHandler = () =>{
       let date = $('#Edit_On_event_date').val()
       let event_name = $('#edit_event_name').val()
       let event_cost = $('#edit_event_cost').val()
       let total_guest = $('#edit_event_number_guest').val()
       let contact = $('#edit_contact').val()
       let edit_id = $('#edit_id').val()
       let hall_select = document.getElementsByName("edit_hall");
        for (i = 0; i < hall_select.length; i++) {
          if (hall_select[i].checked) {
            hall = hall_select[i].value;
          }
        }
        console.log(hall)
       let editDataObj = {
          inqid: edit_id,
          idate: date,
          ihijtidate: "HIJRI DATE",
          iname: "hello Name",
          iaddress: "ADDREESS",
          icontact: contact,
          icnic: "421010-49239482-4",
          iemail: "EMMADSADIQ@GMAIL.COM",
          iportion: hall,
          ievent: event_name,
          icost: event_cost,
          iguest: total_guest,
       }
       fetch("http://localhost/API_Inquery/api-update.php", {
          method: "POST",
          body: JSON.stringify(editDataObj),
        })
          .then((result) => {
            result.json();
          })
          .catch((err) => {
            throw err;
          });


     }
    </script>
  </body>
</html>
